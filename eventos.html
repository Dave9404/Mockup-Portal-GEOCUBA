<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <link rel="shortcut icon" href="/assets/images/icon2x-354x158.png" type="image/x-icon">
    <meta name="description" content="">
    <title>Eventos - GEOCUBA</title>
    <!-- API Functions - Plain HTTP URLs without templates -->
    <script>
        // Helper function to format text content with proper paragraphs
        function formatTextContent(text) {
            if (!text) return '';
            
            // Split by double line breaks to create paragraphs
            const paragraphs = text.split(/\n\s*\n/);
            
            if (paragraphs.length > 1) {
                // Multiple paragraphs - wrap each in <p> tags
                return paragraphs
                    .filter(p => p.trim() !== '')
                    .map(p => `<p>${p.trim()}</p>`)
                    .join('');
            } else {
                // Single paragraph or no clear paragraph breaks
                return text;
            }
        }
        
        // Define API URL helper functions that work with the current page's host
        window.getApiUrl = function(endpoint) {
            // Use the current page's hostname and port
            const currentHost = window.location.hostname;
            const currentPort = window.location.port || '8060';
            return "http://" + currentHost + ":" + currentPort + "/api/" + endpoint;
        };
        
        window.getRelativeApiUrl = function(endpoint) {
            return "/api/" + endpoint;
        };
    </script>
    <link rel="stylesheet" href="/assets/web/assets/mobirise-icons2/mobirise2.css">
    <link rel="stylesheet" href="/assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/bootstrap/css/bootstrap-grid.min.css">
    <link rel="stylesheet" href="/assets/bootstrap/css/bootstrap-reboot.min.css">
    <link rel="stylesheet" href="/assets/dropdown/css/style.css">
    <link rel="stylesheet" href="/assets/socicon/css/styles.css">
    <link rel="stylesheet" href="/assets/theme/css/style.css">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@400;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@400;700&display=swap"></noscript>
    <link rel="preload" as="style" href="/assets/mobirise/css/mbr-additional.css">
    <link rel="stylesheet" href="/assets/mobirise/css/mbr-additional.css" type="text/css">
    
    <!-- API Configuration -->
    <script src="/js/config.js"></script>
    <style>
        .event-card {
            background: #ffffff;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            overflow: hidden;
        }
        
        pre {
            white-space: pre-wrap;       /* CSS3 */
            white-space: -moz-pre-wrap;  /* Firefox */
            white-space: -pre-wrap;      /* Opera <7 */
            white-space: -o-pre-wrap;    /* Opera 7 */
            word-wrap: break-word;       /* IE */
            overflow-x: hidden;          /* Hide horizontal scrollbar */
            max-width: 100%;             /* Ensure it doesn't exceed container width */
            text-align: justify;         /* Justify text for better readability */
            font-family: inherit;        /* Use the same font as the rest of the content */
            margin-bottom: 1rem;         /* Add some spacing */
        }

        .event-content {
            display: flex;
            flex-direction: row;
            min-height: 400px;
        }

        .event-text {
            flex: 1;
            padding: 2rem;
        }

        .event-image {
            flex: 1;
            background-color: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .event-image img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .event-buttons {
            margin-top: 1.5rem;
        }

        .event-buttons .btn {
            margin-right: 1rem;
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            .event-content {
                flex-direction: column;
            }
            
            .event-image {
                min-height: 300px;
            }
        }
    </style>
</head>
<body>
    <section data-bs-version="5.1" class="menu menu1 cid-umARzPo6Q0" once="menu" id="menu01-20">
        <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
            <div class="container">
                <div class="navbar-brand">
                    <span class="navbar-logo">
                        <a href="index.html">
                            <img src="/assets/images/icon2x-354x158.png" alt="Portal Web OSDE GEOCUBA" style="height: 3.7rem;">
                        </a>
                    </span>
                </div>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse"
                    data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent"
                    aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                    <div class="hamburger">
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true">
                        <li class="nav-item">
                            <a class="nav-link link text-black text-primary" href="index.html">
                                <strong>Inicio</strong>
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link link text-black text-primary dropdown-toggle" href="#" data-bs-toggle="dropdown">
                                <strong>Bienes y Servicios</strong>
                            </a>
                            <div id="services-dropdown" class="dropdown-menu"></div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link link text-black text-primary dropdown-toggle" href="#" data-bs-toggle="dropdown">
                                <strong>Empresas</strong>
                            </a>
                            <div id="empresas-dropdown" class="dropdown-menu"></div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link link text-black text-primary" href="eventos.html">
                                <strong>Eventos</strong>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link link text-black text-primary" href="noticias.html">
                                <strong>Noticias</strong>
                            </a>
                        </li>
                    </ul>
                    <div class="icons-menu">
                        <a class="iconfont-wrapper" href="tel:+5359955686" title="Comunicación">
                            <span class="p-2 mbr-iconfont mobi-mbri-phone mobi-mbri"></span>
                        </a>
                        <a class="iconfont-wrapper" href="https://wa.me/5359955686" title="WhatsApp Comunicación">
                            <span class="p-2 mbr-iconfont socicon-whatsapp socicon"></span>
                        </a>
                        <a class="iconfont-wrapper" href="mailto:atencionpoblacion@geocuba.cu">
                            <span class="p-2 mbr-iconfont mobi-mbri-letter mobi-mbri"></span>
                        </a>
                    </div>
                </div>
            </div>
        </nav>
    </section>

    <!-- Header Section -->
    <section data-bs-version="5.1" class="header09 startm5 cid-unWlwWpvkT mbr-parallax-background" id="header09-3s">
        <div class="mbr-overlay" style="opacity: 0.8; background-color: rgb(0, 27, 79);"></div>
        <div class="container">
            <div class="row">
                <div class="content-wrap col-12 col-md-11">
                    <h1 class="mbr-section-title mbr-fonts-style mbr-white mb-4 display-1">
                        <strong>Eventos</strong>
                    </h1>
                    <h2 class="mbr-section-title mbr-fonts-style mbr-white mb-4 display-5">
                        Explora los Eventos Clave donde GEOCUBA Comparte Innovación y Experiencia en Geociencias y Artes Gráficas.
                    </h2>
                </div>
            </div>
        </div>
    </section>

    <!-- Evento Destacado: Geomática 2026 -->
    <section data-bs-version="5.1" class="features4 cid-tJS4jHBHih" id="features4-2">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="event-card featured-event">
                        <div class="event-content">
                            <div class="event-text">
                                <h3 class="mbr-section-title mbr-fonts-style mb-3 display-5">
                                    <strong>Convocatoria a Geomática 2026</strong>
                                </h3>
                                <p class="price mbr-fonts-style mb-3 display-7">
                                    En La Habana, Cuba, del 15 al 19 de marzo de 2026
                                </p>
                                <p class="mbr-text mbr-fonts-style mb-3 display-7">
                                    El Grupo Empresarial GEOCUBA se complace en anunciar la convocatoria para el Congreso Internacional Geomática 2026, un espacio para el intercambio científico y tecnológico en el ámbito de las geociencias, cartografía, teledetección y tecnologías geoespaciales. Invitamos a profesionales, investigadores y estudiantes a participar en este importante evento.
                                </p>
                                <div class="event-buttons">
                                    <a href="#" class="btn btn-lg btn-primary display-7">
                                        <span class="mobi-mbri mobi-mbri-globe-2 mbr-iconfont mbr-iconfont-btn"></span>
                                        Más Información
                                    </a>
                                </div>
                            </div>
                            <div class="event-image">
                                <img src="/assets/images/dsc-3013-1200x797.jpg" alt="Geomática 2026">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Eventos Section -->
    <section data-bs-version="5.1" class="features4 cid-tJS4jHBHih" id="features4-3">
        <div class="container">
            <div class="row" id="eventos-container">
                <!-- Events will be loaded here dynamically -->
            </div>
        </div>
    </section>

    <script>
        // Modern approach using MutationObserver for dynamic menu loading
        async function loadDropdownData() {
            try {
                // Load services
                const servicesResponse = await fetch(getApiUrl('get-services'));
                const services = await servicesResponse.json();
                const servicesDropdown = document.getElementById('services-dropdown');
                
                // Use DocumentFragment for better performance
                const servicesFragment = document.createDocumentFragment();
                services.forEach(service => {
                    const item = document.createElement('a');
                    item.href = `servicios.html?service=${encodeURIComponent(service.nombre)}`;
                    item.textContent = service.nombre;
                    item.className = 'dropdown-item';
                    servicesFragment.appendChild(item);
                });
                servicesDropdown.appendChild(servicesFragment);

                // Load empresas
                const empresasResponse = await fetch(getApiUrl('get-empresas'));
                const empresas = await empresasResponse.json();
                const empresasDropdown = document.getElementById('empresas-dropdown');
                
                // Use DocumentFragment for better performance
                const empresasFragment = document.createDocumentFragment();
                empresas.forEach(empresa => {
                    const item = document.createElement('a');
                    item.href = `empresas.html?empresa=${encodeURIComponent(empresa.empresa)}`;
                    item.textContent = empresa.empresa;
                    item.className = 'dropdown-item';
                    empresasFragment.appendChild(item);
                });
                empresasDropdown.appendChild(empresasFragment);
            } catch (error) {
                console.error('Error loading dropdown data:', error);
            }
        }

        async function loadEventos() {
            try {
                const response = await fetch(getApiUrl('get-eventos'));
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const eventos = await response.json();
                
                const container = document.getElementById('eventos-container');
                container.innerHTML = ''; // Clear existing content
                
                // Use DocumentFragment for better performance
                const fragment = document.createDocumentFragment();
                
                eventos.forEach(evento => {
                    const eventCard = document.createElement('div');
                    eventCard.className = 'col-12';
                    
                    eventCard.innerHTML = `
                        <div class="event-card">
                            <div class="event-content">
                                <div class="event-text">
                                    <h3 class="mbr-section-title mbr-fonts-style mb-3 display-5">
                                        <strong>${evento.titulo}</strong>
                                    </h3>
                                    <p class="price mbr-fonts-style mb-3 display-7">
                                        En ${evento.lugar}, desde el ${evento.fechai} hasta el ${evento.fechaf}
                                    </p>
                                    <pre class="mbr-text mbr-fonts-style mb-3 display-7">
                                        ${evento.descripcion}
                                    </pre>
                                    <div class="event-buttons">
                                        ${evento.link && evento.link.trim() !== '' ? `
                                            <a href="${evento.link}" target="_blank" class="btn btn-lg btn-primary display-7">
                                                <span class="mobi-mbri mobi-mbri-globe-2 mbr-iconfont mbr-iconfont-btn"></span>
                                                Más Información
                                            </a>
                                        ` : ''}
                                        ${evento.descarga && evento.descarga.trim() !== '' ? `
                                            <a href="${evento.descarga}" target="_blank" class="btn btn-lg btn-primary display-7">
                                                <span class="mobi-mbri mobi-mbri-download mbr-iconfont mbr-iconfont-btn"></span>
                                                Descarga PDF
                                            </a>
                                        ` : ''}
                                    </div>
                                </div>
                                <div class="event-image">
                                    <img src="data:image/png;base64,${evento.imagen}" alt="${evento.titulo}">
                                </div>
                            </div>
                        </div>
                    `;
                    
                    fragment.appendChild(eventCard);
                });
                
                container.appendChild(fragment);
                
            } catch (error) {
                console.error('Error loading eventos:', error);
                // Show error message to user
                const container = document.getElementById('eventos-container');
                container.innerHTML = `
                    <div class="col-12">
                        <div class="alert alert-danger" role="alert">
                            Error al cargar los eventos. Por favor, intente más tarde.
                        </div>
                    </div>
                `;
            }
        }

        // Initialize everything when the page loads
        window.addEventListener('load', () => {
            loadDropdownData();
            loadEventos();
        });
    </script>

    <!-- Load scripts asynchronously to prevent blocking -->
    <script src="/assets/bootstrap/js/bootstrap.bundle.min.js" defer></script>
    <script src="/assets/parallax/jarallax.js" defer></script>
    <script src="/assets/smoothscroll/smooth-scroll.js" defer></script>
    <script src="/assets/ytplayer/index.js" defer></script>
    <script src="/assets/dropdown/js/navbar-dropdown.js" defer></script>
    <script src="/assets/theme/js/script.js" defer></script>
</body>
</html>