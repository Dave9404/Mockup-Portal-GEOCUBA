<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image:src" content="/assets/images/artesgraficasgeocuba-meta.png">
  <meta property="og:image" content="/assets/images/artesgraficasgeocuba-meta.png">
  <meta name="twitter:title" content="GEOCUBA Bienes y Servicios">
  <link rel="shortcut icon" href="/assets/images/icon2x-354x158.png" type="image/x-icon">
  <meta name="description" content="Bienes y Servicios del Grupo Empresarial GEOCUBA: cartografía náutica, gestión territorial, estudios medioambientales, geodesia, teledetección, servicios B2B geoespaciales, drones, agricultura de precisión, VANTs, artes gráficas y envases.">
  
  <title>GEOCUBA Bienes y Servicios</title>
  
  <!-- API Functions - Plain HTTP URLs without templates -->
  <script>
    // Define API URL helper functions that work with the current page's host
    window.getApiUrl = function(endpoint) {
      // Use the current page's hostname and port
      const currentHost = window.location.hostname;
      const currentPort = window.location.port || '8060';
      return "http://" + currentHost + ":" + currentPort + "/api/" + endpoint;
    };
    
    window.getRelativeApiUrl = function(endpoint) {
      return "/api/" + endpoint;
    };
  </script>
  
  <link rel="stylesheet" href="/assets/web/assets/mobirise-icons2/mobirise2.css">
  <link rel="stylesheet" href="/assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="/assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="/assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="/assets/parallax/jarallax.css">
  <link rel="stylesheet" href="/assets/animatecss/animate.css">
  <link rel="stylesheet" href="/assets/dropdown/css/style.css">
  <link rel="stylesheet" href="/assets/socicon/css/styles.css">
  <link rel="stylesheet" href="/assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&display=swap"></noscript>
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Inter+Tight:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter+Tight:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="/assets/mobirise/css/mbr-additional.css">
  <link rel="stylesheet" href="/assets/mobirise/css/mbr-additional.css" type="text/css">
  
  <!-- API Configuration -->
  <script src="/js/config.js"></script>
</head>
<body>
  
  <section data-bs-version="5.1" class="menu menu1 cid-umARzPo6Q0" once="menu" id="menu01-20">
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
      <div class="container">
        <div class="navbar-brand">
          <span class="navbar-logo">
            <a href="index.html">
              <img src="/assets/images/icon2x-354x158.png" alt="Portal Web OSDE GEOCUBA" style="height: 3.7rem;">
            </a>
          </span>
        </div>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse"
          data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
          </div>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true">
            <li class="nav-item"><a class="nav-link link text-black text-primary" href="index.html"><strong>Inicio</strong></a></li>
            <li class="nav-item dropdown">
              <a class="nav-link link text-black text-primary dropdown-toggle" href="#" data-bs-toggle="dropdown">
                <strong>Bienes y Servicios</strong>
              </a>
              <div id="services-dropdown" class="dropdown-menu"></div>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link link text-black text-primary dropdown-toggle" href="#" data-bs-toggle="dropdown">
                <strong>Empresas</strong>
              </a>
              <div id="empresas-dropdown" class="dropdown-menu"></div>
            </li>
            <li class="nav-item">
              <a class="nav-link link text-black text-primary" href="eventos.html"><strong>Eventos</strong></a>
            </li>
            <li class="nav-item">
              <a class="nav-link link text-black text-primary" href="noticias.html"><strong>Noticias</strong></a>
            </li>
          </ul>
          <div class="icons-menu">
            <a class="iconfont-wrapper" href="tel:+5359955686" title="Comunicación">
              <span class="p-2 mbr-iconfont mobi-mbri-phone mobi-mbri"></span>
            </a>
            <a class="iconfont-wrapper" href="https://wa.me/5359955686" title="WhatsApp Comunicación">
              <span class="p-2 mbr-iconfont socicon-whatsapp socicon"></span>
            </a>
            <a class="iconfont-wrapper" href="mailto:negocios@geocuba.cu">
              <span class="p-2 mbr-iconfont mobi-mbri-letter mobi-mbri"></span>
            </a>
          </div>
        </div>
      </div>
    </nav>
  </section>
  
  <script>
    async function loadServices() {
      try {
        const response = await fetch(getApiUrl('get-services'));
        if (!response.ok) {
          throw new Error('Failed to fetch services');
        }
        const services = await response.json();

        const dropdown = document.getElementById('services-dropdown');
        services.forEach(service => {
          const item = document.createElement('a');
          item.href = `servicios.html?service=${encodeURIComponent(service.nombre)}`;
          item.textContent = service.nombre;
          item.classList.add('dropdown-item');
          dropdown.appendChild(item);
        });
      } catch (error) {
        console.error('Error loading services:', error);
      }
    }

    loadServices();
    async function loadEmpresas() {
      try {
        const response = await fetch(getApiUrl('get-empresas'));
        if (!response.ok) {
          throw new Error('Failed to fetch empresas');
        }
        const empresas = await response.json();

        const empresasDropdown = document.querySelector('#empresas-dropdown');
        empresas.forEach(empresa => {
          const item = document.createElement('a');
          item.href = `empresas.html?empresa=${encodeURIComponent(empresa.empresa)}`;
          item.textContent = empresa.empresa;
          item.classList.add('dropdown-item');
          empresasDropdown.appendChild(item);
        });
      } catch (error) {
        console.error('Error loading empresas:', error);
      }
    }

    loadEmpresas();
  </script>

  <section data-bs-version="5.1" class="header09 startm5 cid-umSWkMmEmJ mbr-parallax-background" id="header09-2e">    
    <div class="mbr-overlay" style="opacity: 0.8; background-color: rgb(89, 5, 4);"></div>
    
    <div class="container">
      <div class="row">
        <div class="content-wrap col-12 col-md-11">
          <h1 id="SevicioTitulo" class="mbr-section-title mbr-fonts-style mbr-white mb-4 display-1"></h1>
          <h2 id="AGDescripcion" class="mbr-section-title mbr-fonts-style mbr-white mb-4 display-5"></h2>
          
          <div class="mbr-section-btn" style="display: none;">
            <a id="BtonContacto" class="btn btn-primary display-7" href="#">
              <span class="socicon socicon-whatsapp socicon"></span>Contáctenos
            </a>
          </div>
          <div id="Imagen1" style="display: none;"></div>
        </div>
      </div>
    </div>
  </section>

  <section data-bs-version="5.1" class="features15 cid-umU0yryzz1" id="features015-2r">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 content-head">
          <div class="mbr-section-head mb-5">
            <h4 class="mbr-section-title mbr-fonts-style align-center mb-0 display-2">
              <strong>Bienes y Servicios</strong></h4>
          </div>
        </div>
      </div>
      <div id="product-lines-container" class="row">
        <!-- Product lines will be loaded dynamically -->
      </div>
    </div>
  </section>

  <section data-bs-version="5.1" class="header12 cid-umUfWvOzfY" id="header12-2w">
    <div class="text-center container">
      <div class="row justify-content-center">
        <div class="col-md-12 content-head">
          <h1 class="mbr-section-title mbr-fonts-style mb-4 display-1">
            <strong>Contáctanos</strong></h1>
          <p class="mbr-text mbr-fonts-style mb-4 display-7">
            Te invitamos a contactar a GEOCUBA para consultas sobre nuestros bienes y servicios. Estamos listos para ofrecerte soluciones integradas al medio geográfico con calidad, innovación y eficiencia. ¡Esperamos tu mensaje!
          </p>
          <div class="mbr-section-btn mt-4">
            <a class="btn btn-primary display-7" href="mailto:atencioncliente@geocuba.cu">
              <span class="mobi-mbri mobi-mbri-letter mbr-iconfont mbr-iconfont-btn"></span>Mándanos un Correo
            </a>
            <a class="btn btn-primary display-7" href="tel:+535555555">
              <span class="mobi-mbri mobi-mbri-phone mbr-iconfont mbr-iconfont-btn"></span>Haznos una Llamada
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section data-bs-version="5.1" class="clients3 cid-upSSOFLxes" id="clients03-45">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 content-head">
          <div class="mb-5">
            <h5 class="mbr-section-title mbr-fonts-style mb-0 display-2">
              <strong>Nuestros Clientes</strong>
            </h5>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="item features-without-image col-12 col-lg-4">
          <div class="item-wrapper">
            <div class="img-wrapper">
              <img src="/assets/images/ciego-montero-201x201.png" alt="Cliente GEOCUBA">
            </div>
          </div>
        </div>
        <div class="item features-without-image col-12 col-lg-4">
          <div class="item-wrapper">
            <div class="img-wrapper">
              <img src="/assets/images/havana-club-201x201.png" alt="Cliente GEOCUBA">
            </div>
          </div>
        </div>
        <div class="item features-without-image col-12 col-lg-4">
          <div class="item-wrapper">
            <div class="img-wrapper">
              <img src="/assets/images/minsap-201x201.png" alt="Cliente GEOCUBA">
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section data-bs-version="5.1" class="footer4 cid-upSkgG6xcG" once="footers" id="footer04-44">
    <div class="container">
      <div class="media-container-row align-center mbr-white">
        <div class="col-12">
          <p class="mbr-text mb-0 mbr-fonts-style display-7">GEOCUBA 2025</p>
        </div>
      </div>
    </div>
  </section>

  <script src="/assets/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="/assets/parallax/jarallax.js"></script>
  <script src="/assets/smoothscroll/smooth-scroll.js"></script>
  <script src="/assets/ytplayer/index.js"></script>
  <script src="/assets/dropdown/js/navbar-dropdown.js"></script>
  <script src="/assets/scrollgallery/scroll-gallery.js"></script>
  <script src="/assets/theme/js/script.js"></script>

  <input name="animation" type="hidden">
  <script>
    async function loadServiceDetails() {
      try {
        const urlParams = new URLSearchParams(window.location.search);
        const serviceName = urlParams.get('service');
        
        if (!serviceName) {
          console.error('No service name provided in URL');
          return;
        }

        const contactButton = document.querySelector('.mbr-section-btn');
        if (contactButton) {
          contactButton.style.display = 'none';
        }

        const response = await fetch(getApiUrl(`get-service/${encodeURIComponent(serviceName)}`));
        if (!response.ok) throw new Error('Failed to fetch service details');

        const serviceData = await response.json();

        document.getElementById('SevicioTitulo').innerHTML = `<strong>${serviceData.service.nombre}</strong>`;
        document.getElementById('AGDescripcion').innerHTML = serviceData.service.descripcion;

        const imagen1Div = document.getElementById('Imagen1');
        if (serviceData.service.img) {
          if (typeof serviceData.service.img === 'string') {
            imagen1Div.style.backgroundImage = `url(${serviceData.service.img})`;
          } else if (serviceData.service.img.data) {
            try {
              // Safely handle binary data with a size limit
              const imageData = serviceData.service.img.data;
              // Check if data needs to be processed as array or is already in a usable format
              let base64Image;
              if (Array.isArray(imageData) || imageData instanceof Uint8Array) {
                // Limit the size to prevent stack overflow
                if (imageData.length > 1000000) { // ~1MB limit
                  console.warn('Image too large, using placeholder');
                  imagen1Div.style.backgroundImage = 'url(/assets/images/placeholder.jpg)';
                } else {
                  base64Image = btoa(
                    Array.from(new Uint8Array(imageData))
                      .map(byte => String.fromCharCode(byte))
                      .join('')
                  );
                  imagen1Div.style.backgroundImage = `url(data:image/jpeg;base64,${base64Image})`;
                }
              } else if (typeof imageData === 'string') {
                // Already a string, might be base64 or URL
                imagen1Div.style.backgroundImage = `url(${imageData})`;
              } else {
                console.warn('Unknown image format, using placeholder');
                imagen1Div.style.backgroundImage = 'url(/assets/images/placeholder.jpg)';
              }
            } catch (imageError) {
              console.error('Error processing image:', imageError);
              imagen1Div.style.backgroundImage = 'url(/assets/images/placeholder.jpg)';
            }
          }
          imagen1Div.style.display = 'block';
        }

        // Load product lines dynamically
        const productLinesContainer = document.getElementById('product-lines-container');
        productLinesContainer.innerHTML = ''; // Clear existing content

        if (!serviceData.productLines || serviceData.productLines.length === 0) {
          console.log('No product lines found in database, showing default content');
          // Default product lines
          const defaultProductLines = [
            {
              titulo: "Formas Comerciales",
              descripcion: "Impresos Comerciales y Operacionales",
              img: "/assets/images/imprenta-2-700x450.jpeg"
            },
            {
              titulo: "Etiquetas Autoadhesivas",
              descripcion: "Etiquetas Autoadhesivas en rollo o en pliego",
              img: "/assets/images/large-offset-printing-press-magazine-running-long-roll-off-paper-production-line-industrial-printer-machine-640w-1.webp"
            },
            {
              titulo: "Etiquetas no Autoadhesivas",
              descripcion: "Etiquetas de BOPP en rollos",
              img: "/assets/images/a-86-600x400.jpeg"
            },
            {
              titulo: "Marquillas, envolturas y sellos",
              descripcion: "Envoltura para tabacos",
              img: "/assets/images/imagen8-245x326.png"
            },
            {
              titulo: "Maquetas e impresión 3D",
              descripcion: "Maquetas arquitectónicas",
              img: "/assets/images/maqueta-192x163.png"
            },
            {
              titulo: "Envases Flexibles",
              descripcion: "Bolsas selladas a tres caras",
              img: "/assets/images/imagen4-341x455.png"
            }
          ];
          serviceData.productLines = defaultProductLines;
        }
          
        serviceData.productLines.forEach(line => {
          const col = document.createElement('div');
          col.className = 'col-12 col-lg-4 mb-4';
            
          const card = document.createElement('div');
          card.className = 'card';
            
          const imgWrapper = document.createElement('div');
          imgWrapper.className = 'card-img-top';
            
          if (line.img) {
            const img = document.createElement('img');
            if (typeof line.img === 'string') {
              img.src = line.img;
            } else if (line.img.data) {
              try {
                // Safely handle binary data with a size limit
                const imageData = line.img.data;
                // Check if data needs to be processed as array or is already in a usable format
                let base64Image;
                if (Array.isArray(imageData) || imageData instanceof Uint8Array) {
                  // Limit the size to prevent stack overflow
                  if (imageData.length > 1000000) { // ~1MB limit
                    console.warn('Image too large, using placeholder');
                    img.src = '/assets/images/placeholder.jpg';
                  } else {
                    base64Image = btoa(
                      Array.from(new Uint8Array(imageData))
                        .map(byte => String.fromCharCode(byte))
                        .join('')
                    );
                    img.src = `data:image/jpeg;base64,${base64Image}`;
                  }
                } else if (typeof imageData === 'string') {
                  // Already a string, might be base64 or URL
                  img.src = imageData;
                } else {
                  console.warn('Unknown image format, using placeholder');
                  img.src = '/assets/images/placeholder.jpg';
                }
              } catch (imageError) {
                console.error('Error processing image:', imageError);
                img.src = '/assets/images/placeholder.jpg';
              }
            }
            img.alt = line.titulo;
            imgWrapper.appendChild(img);
          }

          const cardBody = document.createElement('div');
          cardBody.className = 'card-body';
            
          const title = document.createElement('h5');
          title.className = 'card-title mbr-fonts-style display-7';
          title.innerHTML = `<strong>${line.titulo}</strong>`;
            
          const desc = document.createElement('p');
          desc.className = 'card-text mbr-fonts-style display-7';
          desc.textContent = line.descripcion;
            
          cardBody.appendChild(title);
          cardBody.appendChild(desc);
          card.appendChild(imgWrapper);
          card.appendChild(cardBody);
          col.appendChild(card);
          productLinesContainer.appendChild(col);
        });
      } catch (error) {
        console.error('Error loading service details:', error);
      }
    }

    document.addEventListener('DOMContentLoaded', loadServiceDetails);
  </script>
</body>
</html>